<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">

  <?define Manufacturer        = "Immo Landwerth" ?>
  <?define ProductName         = "NuProj" ?>
  <?define ProductHomePage     = "http://nuproj.codeplex.com" ?>
  <?define UpgradeCode         = "73875B23-C4D8-49CC-B34D-380325A4A0D8" ?>

  <Product Id="*"
           Name="$(var.ProductName)"
           Language="1033"
           Version="!(bind.fileVersion.NuProj.Tasks.dll)"
           Manufacturer="$(var.Manufacturer)"
           UpgradeCode="$(var.UpgradeCode)">

    <Package InstallerVersion="200"
             Compressed="yes"
             InstallScope="perMachine" />

    <MajorUpgrade AllowSameVersionUpgrades="yes"
                  DowngradeErrorMessage="A newer version of [ProductName] is already installed." />

    <MediaTemplate EmbedCab="yes" />

    <Feature Id="ProductFeature"
             Title="$(var.ProductName)"
             Level="1">
      <ComponentGroupRef Id="ProductComponents" />
    </Feature>

    <WixVariable Id="WixUILicenseRtf"
                 Value="Resources\License.rtf" />

    <UI>
      <UIRef Id="WixUI_Minimal" />
    </UI>
  </Product>

  <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="MSBuild" Name="MSBuild">
          <Directory Id="INSTALLDIR" Name="$(var.ProductName)" />
        </Directory>
      </Directory>
    </Directory>
  </Fragment>

  <Fragment>
    <ComponentGroup Id="ProductComponents" Directory="INSTALLDIR">
      <Component>
        <File Source="$(var.NuProj.Tasks.TargetDir)NuGet.exe" />
      </Component>
      <Component>
        <File Source="$(var.NuProj.Tasks.TargetDir)NuProj.targets" />
      </Component>
      <Component>
        <File Source="$(var.NuProj.Tasks.TargetDir)NuProj.Tasks.dll" />
      </Component>
    </ComponentGroup>
  </Fragment>
</Wix>